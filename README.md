# Nepal IPO Radar - Fullstack Application

A robust, fullstack application to track Initial Public Offerings (IPOs) in Nepal.
Supports both **Google Gemini API** (Official) and **OpenRouter** (Perplexity Online) for data gathering.

## Features
- **Hybrid AI Engine**: 
  - Detects `AIza...` keys and uses Google Gemini with Search Grounding.
  - Detects `sk-or...` keys and uses OpenRouter with Perplexity Online.
- **Data Persistence**: Stores results in Supabase to ensure no data is lost between scans.
- **Automated Alerts**: Sends email notifications via Gmail SMTP.

## Setup Instructions

### 1. Database (Supabase)
This app uses `@supabase/supabase-js` which connects via **HTTPS (Port 443)**.
*You do NOT need to worry about the "Supabase IPv4" connection pooling issue* because we are not using a direct TCP connection to the database.

1. Go to your Supabase Project -> Settings -> API.
2. Copy the **Project URL** and **anon / public** Key.
3. Run the SQL from the `sql/schema.sql` (or see below) in the Supabase SQL Editor.

**SQL Schema:**
```sql
create table ipos (
  id bigint generated by default as identity primary key,
  created_at timestamp with time zone default timezone('utc'::text, now()) not null,
  company_name text not null,
  sector text,
  share_type text not null default 'General Public',
  status text,
  units numeric,
  price numeric,
  opening_date text,
  closing_date text,
  description text,
  min_units numeric,
  max_units numeric,
  rating text,
  project_description text,
  risks text,
  source_url text,
  constraint ipos_company_share_unique unique (company_name, share_type)
);

create table subscribers (
  id bigint generated by default as identity primary key,
  created_at timestamp with time zone default timezone('utc'::text, now()) not null,
  email text unique not null
);
```

### 2. Environment Variables
Add these to your `.env` file or Vercel Project Settings:

| Variable | Value |
| --- | --- |
| `API_KEY` | Your **Google Gemini Key** OR **OpenRouter Key**. |
| `VITE_SUPABASE_URL` | Your Supabase Project URL (e.g., `https://xyz.supabase.co`) |
| `VITE_SUPABASE_KEY` | Your Supabase Public Anon Key |
| `GMAIL_USER` | Your Gmail address |
| `GMAIL_APP_PASSWORD` | Gmail App Password (16 chars) |
| `ALERT_RECIPIENT_EMAIL` | Email to receive alerts |

### 3. Deployment
Deploy to Vercel. The `api/` directory will automatically be treated as Serverless Functions for email alerts.
